# Older versions of Docker were called docker or docker-engine. If these are installed, uninstall them, along with associated dependencies.
- name: remove Old docker package
  yum:
    name: "{{ item }}"
    state: removed
  loop: "{{ remove_packages }}"

# Install the yum-utils package (which provides the yum-config-manager utility) and set up the repository.

# install docker engine
- name: install yum-utils package 
  yum:
    name: yum-utils
    state: latest

#add docker repository
- name: add docker repository
  shell: yum-config-manager --add-repo "{{ docker_repo }}"

# install docker engine
- name: install Docker package
  yum:
    name: "{{ item }}"
    state: latest
  loop: "{{ docker_packges }}"

#start Dcoker Engine service
- name: Start Docker Engine
  service:
    name: docker
    state: started
    enabled: yes

# Check if the docker-compsoe is already installed
- name: Check that the docker-compose
  stat:
    path: /usr/bin/docker-compose
  register: file_status


# docker-compose installtion
- name: Download docker-compose binary file
  shell: curl -SL https://github.com/docker/compose/releases/download/v2.14.0/docker-compose-linux-x86_64 -o /usr/local/bin/docker-compose
  when: file_status.stat.exists == False

- name: Create short cut 
  shell: ln -s /usr/local/bin/docker-compose /usr/bin/docker-compose
  when: file_status.stat.exists == False
  